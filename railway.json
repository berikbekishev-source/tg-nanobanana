{
  "services": {
    "web": {
      "startCommand": "./.venv/bin/python manage.py collectstatic --noinput && ./.venv/bin/python manage.py migrate && ./.venv/bin/python manage.py set_webhook && ./.venv/bin/gunicorn -k uvicorn.workers.UvicornWorker config.asgi:application --bind 0.0.0.0:$PORT --workers 2 --timeout 120"
    },
    "worker": {
      "startCommand": "./.venv/bin/celery -A config.celery:app worker -Q default -l INFO --concurrency=2",
      "installCommand": "apt-get update && apt-get install -y ffmpeg && python3.11 -m venv .venv && ./.venv/bin/pip install --upgrade pip && ./.venv/bin/pip install -r requirements.txt"
    },
    "beat": {
      "installCommand": "apt-get update && apt-get install -y ffmpeg && python3.11 -m venv .venv && ./.venv/bin/pip install --upgrade pip && ./.venv/bin/pip install -r requirements.txt",
      "startCommand": "./.venv/bin/celery -A config.celery:app beat -l INFO"
    }
  }
}
